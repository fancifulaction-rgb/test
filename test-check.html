<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º—ã v5.3</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #f5f5f5; 
        }
        .test-result { 
            padding: 15px; 
            margin: 10px 0; 
            border-radius: 8px; 
        }
        .pass { 
            background: #d4edda; 
            border: 1px solid #c3e6cb; 
            color: #155724; 
        }
        .fail { 
            background: #f8d7da; 
            border: 1px solid #f5c6cb; 
            color: #721c24; 
        }
        .warning { 
            background: #fff3cd; 
            border: 1px solid #ffeaa7; 
            color: #856404; 
        }
        .test-button { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px; 
        }
        .test-button:hover { 
            background: #0056b3; 
        }
        pre { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 5px; 
            overflow: auto; 
            font-size: 12px; 
        }
    </style>
</head>
<body>
    <h1>üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ù–æ–≤–æ–≥–æ–¥–Ω–µ–π –æ—Ö–æ—Ç—ã –∑–∞ —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏ v5.3</h1>
    
    <div id="test-results"></div>
    
    <div style="margin: 20px 0;">
        <button class="test-button" onclick="runAllTests()">üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã</button>
        <button class="test-button" onclick="clearResults()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
    </div>

    <h2>üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤:</h2>
    <div id="results-log"></div>

    <script>
        function addTestResult(testName, passed, message, details = '') {
            const results = document.getElementById('results-log');
            const className = passed ? 'pass' : 'fail';
            const icon = passed ? '‚úÖ' : '‚ùå';
            
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${className}`;
            resultDiv.innerHTML = `
                <h3>${icon} ${testName}</h3>
                <p>${message}</p>
                ${details ? `<pre>${details}</pre>` : ''}
            `;
            
            results.appendChild(resultDiv);
        }

        function clearResults() {
            document.getElementById('results-log').innerHTML = '';
        }

        function runAllTests() {
            clearResults();
            
            // –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ–∞–π–ª–æ–≤
            console.log('üîç –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤...');
            checkFiles();
            
            // –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
            console.log('üîç –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ 2: Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è...');
            setTimeout(checkFirebase, 1000);
            
            // –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ JSON —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
            console.log('üîç –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ 3: JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞...');
            setTimeout(checkJSON, 2000);
            
            // –¢–µ—Å—Ç 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ JavaScript –æ—à–∏–±–æ–∫
            console.log('üîç –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ 4: JavaScript –æ—à–∏–±–∫–∏...');
            setTimeout(checkJS, 3000);
        }

        function checkFiles() {
            const requiredFiles = [
                'index.html',
                'admin.html', 
                'firebase-config.js',
                'game-data.json'
            ];

            let allFilesExist = true;
            let fileList = '';

            requiredFiles.forEach(file => {
                fetch(file)
                    .then(response => {
                        if (response.ok) {
                            fileList += `‚úÖ ${file} - –Ω–∞–π–¥–µ–Ω\n`;
                        } else {
                            fileList += `‚ùå ${file} - –ù–ï –ù–ê–ô–î–ï–ù (${response.status})\n`;
                            allFilesExist = false;
                        }
                    })
                    .catch(error => {
                        fileList += `‚ùå ${file} - –û–®–ò–ë–ö–ê: ${error.message}\n`;
                        allFilesExist = false;
                    });
            });

            setTimeout(() => {
                addTestResult(
                    '–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å–∏—Å—Ç–µ–º—ã',
                    allFilesExist,
                    allFilesExist ? '–í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç' : '–ù–∞–π–¥–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å —Ñ–∞–π–ª–∞–º–∏',
                    fileList
                );
            }, 500);
        }

        function checkFirebase() {
            fetch('firebase-config.js')
                .then(response => response.text())
                .then(content => {
                    const hasApiKey = content.includes('AIzaSyDVAchLp0xaAqF79A3R36EhrcN_nKDTdyg');
                    const hasAccessCode = content.includes('ChristmasGame2025!');
                    const hasEnabled = content.includes('enabled: true');
                    
                    const checks = [
                        { name: 'API –∫–ª—é—á', pass: hasApiKey },
                        { name: '–ö–æ–¥ –¥–æ—Å—Ç—É–ø–∞', pass: hasAccessCode },
                        { name: '–í–∫–ª—é—á–µ–Ω —Ä–µ–∂–∏–º', pass: hasEnabled }
                    ];
                    
                    const allPass = checks.every(check => check.pass);
                    const details = checks.map(check => 
                        `${check.pass ? '‚úÖ' : '‚ùå'} ${check.name}`
                    ).join('\n');
                    
                    addTestResult(
                        'Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è',
                        allPass,
                        allPass ? 'Firebase –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω' : '–ü—Ä–æ–±–ª–µ–º—ã —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π Firebase',
                        details
                    );
                })
                .catch(error => {
                    addTestResult(
                        'Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è',
                        false,
                        '–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏',
                        error.message
                    );
                });
        }

        function checkJSON() {
            fetch('game-data.json')
                .then(response => response.json())
                .then(data => {
                    const checks = [
                        { name: '–°—Ç—Ä—É–∫—Ç—É—Ä–∞ game', pass: data.game && data.game.title },
                        { name: '–ó–∞–¥–∞–Ω–∏—è', pass: Array.isArray(data.tasks) && data.tasks.length > 0 },
                        { name: '–í–µ—Ä—Å–∏—è 5.3', pass: data.game && data.game.version === '5.3' },
                        { name: '5 –∑–∞–¥–∞–Ω–∏–π', pass: data.tasks && data.tasks.length === 5 }
                    ];
                    
                    const allPass = checks.every(check => check.pass);
                    const details = checks.map(check => 
                        `${check.pass ? '‚úÖ' : '‚ùå'} ${check.name}`
                    ).join('\n');
                    
                    addTestResult(
                        'JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö',
                        allPass,
                        allPass ? 'JSON –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω' : '–ü—Ä–æ–±–ª–µ–º—ã —Å JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π',
                        details
                    );
                })
                .catch(error => {
                    addTestResult(
                        'JSON —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö',
                        false,
                        '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏/–ø–∞—Ä—Å–∏–Ω–≥–∞ JSON',
                        error.message
                    );
                });
        }

        function checkJS() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ JavaScript –æ—à–∏–±–∫–∏ –≤ index.html
            fetch('index.html')
                .then(response => response.text())
                .then(content => {
                    const issues = [];
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
                    if (!content.includes('function showHint()')) {
                        issues.push('‚ùå –§—É–Ω–∫—Ü–∏—è showHint –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    }
                    
                    if (!content.includes('showAlert(')) {
                        issues.push('‚ùå –§—É–Ω–∫—Ü–∏—è showAlert –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    }
                    
                    if (!content.includes('updateProgress()')) {
                        issues.push('‚ùå –§—É–Ω–∫—Ü–∏—è updateProgress –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    }
                    
                    if (content.includes('GAME_CONFIG.gameState.score')) {
                        issues.push('‚ùå –ù–∞–π–¥–µ–Ω–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è score');
                    }
                    
                    const hasIssues = issues.length > 0;
                    const details = hasIssues ? issues.join('\n') : '‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã';
                    
                    addTestResult(
                        'JavaScript –ø—Ä–æ–≤–µ—Ä–∫–∞',
                        !hasIssues,
                        hasIssues ? '–ù–∞–π–¥–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã –≤ JavaScript' : 'JavaScript –≤—ã–≥–ª—è–¥–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º',
                        details
                    );
                })
                .catch(error => {
                    addTestResult(
                        'JavaScript –ø—Ä–æ–≤–µ—Ä–∫–∞',
                        false,
                        '–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è index.html',
                        error.message
                    );
                });
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            setTimeout(runAllTests, 1000);
        });
    </script>
</body>
</html>